---
title: Webhooks
description: "Receive real-time notifications about email events"
---

# Webhooks

Webhooks provide real-time notifications when events occur in your Lettr account. Instead of polling the API for updates, webhooks push event data to your server the moment something happens—whether an email is delivered, a recipient clicks a link, or an inbound email arrives.

## How Webhooks Work

When an event occurs, Lettr sends an HTTP POST request to your configured endpoint with a JSON payload describing the event. Your server processes the event and responds with a success status code.

<Steps>
  <Step title="Event Occurs">
    An email is sent, delivered, bounced, opened, or received on your inbound domain.
  </Step>
  <Step title="Lettr Sends Webhook">
    A signed POST request is sent to your endpoint with the event payload.
  </Step>
  <Step title="You Verify & Process">
    Your server verifies the signature, processes the event, and responds with a 2xx status.
  </Step>
  <Step title="Lettr Confirms Receipt">
    Upon receiving a success response, Lettr marks the delivery as complete.
  </Step>
</Steps>

## Use Cases

Webhooks enable powerful real-time integrations:

| Event Type | Use Case |
|------------|----------|
| `email.delivered` | Update your database when emails are successfully delivered |
| `email.bounced` | Remove invalid addresses from your mailing list |
| `email.opened` | Track engagement metrics and trigger follow-up sequences |
| `email.clicked` | Measure link performance and user interest |
| `email.complained` | Immediately suppress users who mark emails as spam |
| `email.received` | Process inbound emails, create support tickets, track replies |

## Creating a Webhook

You can create webhooks through the dashboard or API.

### Via Dashboard

1. Navigate to **Settings** → **Webhooks**
2. Click **Create Webhook**
3. Enter your endpoint URL
4. Select the events you want to receive
5. Configure authentication (optional but recommended)
6. Click **Save**

### Via API

```javascript
const webhook = await lettr.webhooks.create({
  name: 'Production Events',
  url: 'https://api.example.com/webhooks/lettr',
  events: ['email.delivered', 'email.bounced', 'email.opened', 'email.received'],
  auth_type: 'basic',
  auth_username: 'webhook',
  auth_password: 'your-secure-password'
});

// Store the webhook ID for management
console.log(webhook.id);
```

<Note>
  When you create a webhook, Lettr generates a signing secret. Store this secret securely—you'll need it to verify webhook signatures.
</Note>

## Webhook Payload Structure

All webhook events share a common structure:

```json
{
  "id": "evt_1234567890abcdef",
  "type": "email.delivered",
  "createdAt": "2024-01-15T10:30:00Z",
  "data": {
    // Event-specific data
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `id` | string | Unique identifier for this event |
| `type` | string | The event type (e.g., `email.delivered`, `email.received`) |
| `createdAt` | string | ISO 8601 timestamp when the event occurred |
| `data` | object | Event-specific payload data |

## Handling Webhooks

Here's a complete example of a webhook handler in Node.js with Express:

```javascript
import express from 'express';
import { verifyWebhook } from 'lettr';

const app = express();

// Important: Use raw body for signature verification
app.post('/webhooks/lettr', express.raw({ type: 'application/json' }), async (req, res) => {
  const signature = req.headers['lettr-signature'];

  try {
    // Verify the webhook signature
    const event = verifyWebhook(
      req.body,
      signature,
      process.env.LETTR_WEBHOOK_SECRET
    );

    // Handle different event types
    switch (event.type) {
      case 'email.delivered':
        await handleEmailDelivered(event.data);
        break;

      case 'email.bounced':
        await handleEmailBounced(event.data);
        break;

      case 'email.opened':
        await handleEmailOpened(event.data);
        break;

      case 'email.clicked':
        await handleEmailClicked(event.data);
        break;

      case 'email.complained':
        await handleSpamComplaint(event.data);
        break;

      case 'email.received':
        await handleInboundEmail(event.data);
        break;

      default:
        console.log(`Unhandled event type: ${event.type}`);
    }

    // Always respond with 200 to acknowledge receipt
    res.sendStatus(200);
  } catch (err) {
    console.error('Webhook error:', err.message);
    res.sendStatus(400);
  }
});

async function handleEmailDelivered(data) {
  console.log(`Email ${data.emailId} delivered to ${data.to}`);
  await db.emails.update(data.emailId, { status: 'delivered' });
}

async function handleEmailBounced(data) {
  console.log(`Email bounced: ${data.to} - ${data.bounceType}`);
  await db.suppressions.add(data.to, 'bounce');
}

async function handleInboundEmail(data) {
  console.log(`Received email from ${data.from}: ${data.subject}`);
  await createSupportTicket({
    sender: data.from,
    subject: data.subject,
    body: data.text || data.html
  });
}

app.listen(3000);
```

## Event Categories

Lettr webhooks are organized into categories:

### Outbound Email Events

Events related to emails you send through Lettr:

- `email.sent` - Email accepted by Lettr for delivery
- `email.delivered` - Email delivered to recipient's mail server
- `email.bounced` - Email bounced (hard or soft)
- `email.deferred` - Email delivery temporarily delayed
- `email.opened` - Recipient opened the email
- `email.clicked` - Recipient clicked a link
- `email.complained` - Recipient marked email as spam
- `email.unsubscribed` - Recipient unsubscribed

### Inbound Email Events

Events for emails received on your inbound domains:

- `email.received` - Email received on your inbound domain

<Tip>
  Subscribe only to the events you need. This reduces unnecessary traffic and processing on your server.
</Tip>

## Subscribing to Events

When creating or updating a webhook, specify which events to receive:

```javascript
// Subscribe to specific events
const webhook = await lettr.webhooks.create({
  url: 'https://example.com/webhooks',
  events: ['email.delivered', 'email.bounced', 'email.received']
});

// Subscribe to all events
const webhook = await lettr.webhooks.create({
  url: 'https://example.com/webhooks',
  events: ['*']
});

// Subscribe to all email events (both inbound and outbound)
const webhook = await lettr.webhooks.create({
  url: 'https://example.com/webhooks',
  events: ['email.*']
});
```

## Managing Webhooks

### List Webhooks

```javascript
const webhooks = await lettr.webhooks.list();

webhooks.forEach(webhook => {
  console.log({
    id: webhook.id,
    name: webhook.name,
    url: webhook.url,
    enabled: webhook.enabled,
    events: webhook.event_types
  });
});
```

### Update a Webhook

```javascript
await lettr.webhooks.update('wh_123', {
  url: 'https://new-endpoint.example.com/webhooks',
  events: ['email.delivered', 'email.bounced']
});
```

### Enable/Disable a Webhook

```javascript
// Disable temporarily
await lettr.webhooks.update('wh_123', { enabled: false });

// Re-enable
await lettr.webhooks.update('wh_123', { enabled: true });
```

### Delete a Webhook

```javascript
await lettr.webhooks.delete('wh_123');
```

## Best Practices

<AccordionGroup>
  <Accordion title="Respond Quickly">
    Return a 200 response as soon as possible. If processing takes time, acknowledge receipt immediately and process asynchronously. Lettr waits up to 30 seconds for a response before marking the delivery as failed.
  </Accordion>
  <Accordion title="Verify Signatures">
    Always verify the webhook signature before processing. This ensures the request came from Lettr and hasn't been tampered with.
  </Accordion>
  <Accordion title="Handle Duplicates">
    Implement idempotency in your handler. Due to retries, you may receive the same event multiple times. Use the event `id` to detect and skip duplicates.
  </Accordion>
  <Accordion title="Use HTTPS">
    Always use HTTPS endpoints. Lettr will not send webhooks to insecure HTTP URLs in production.
  </Accordion>
  <Accordion title="Monitor Failures">
    Set up alerting for webhook failures. The dashboard shows delivery status and recent failures for each webhook.
  </Accordion>
</AccordionGroup>

## Learn More

<CardGroup cols={2}>
  <Card title="Event Types" icon="list" href="/learn/webhooks/event-types">
    Complete reference of all webhook events and payloads
  </Card>
  <Card title="Handling Webhooks" icon="code" href="/learn/webhooks/handling">
    Best practices for processing webhooks reliably
  </Card>
  <Card title="Authorization" icon="lock" href="/learn/webhooks/authorization">
    Secure your endpoints with signature verification
  </Card>
  <Card title="Retries" icon="rotate" href="/learn/webhooks/retries">
    Understand retry behavior and failure handling
  </Card>
  <Card title="Testing" icon="flask" href="/learn/webhooks/testing">
    Test webhooks locally and in production
  </Card>
</CardGroup>
